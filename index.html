<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
    <title>Projekt na rzecz MMM</title>
  </head>
  <body>
    <div class="schematic">
      U + RC + RC
      someday...
    </div>
    <button type="button" onclick="Step()">STEP</button>
    <div class="matrixForm">

    </div>
    <div class="plot1">

    </div>
    <div class="plot1">

    </div>
  </body>

  <script type="text/javascript">
    function Array2d(y, x) {
      let result = [];
      for (var i = 0; i < y; i++) {
        result.push(new Array(x));
      }
      return result.slice();
    }

    Array.prototype.Multiply = function(arr) {
      let result = Array2d(this.length, arr[0].length);

      for (var y = 0; y < result.length; y++) {
        for (var x = 0; x < result[0].length; x++) {
          result[y][x] = 0;
          for (var i = 0; i < arr.length; i++) {
            result[y][x] += this[y][i] * arr[i][x];
          }
        }
      }

      return result;
    }

    Array.prototype.Add = function(arr) {
      let result = Array2d(this.length, this[0].length);

      for (var y = 0; y < this.length; y++) {
        for (var x = 0; x < this[0].length; x++) {
          result[y][x] = this[y][x] + arr[y][x];
        }
      }
      return result;
    }


    var C1 = 1;   // [F]
    var C2 = 2;   // [F]
    var R1 = 1;   // [ohm]
    var R2 = 2;   // [ohm]

    var AMatrix = CalcAMatrix();
    var BMatrix = CalcBMatrix();
    var XMatrix = [[0],[0]];
    var XDMatrix = [[0],[0]];
    var UMatrix = CalcUMatrix();

    function CalcAMatrix(){
      let a1 = -(R1+R2)/(C1*R1*R2);
      let a2 = 1/(C1*R2);
      let a3 = 1/(C2*R2);
      let a4 = -1/(C2*R2);
      return [[a1, a2],[a3, a4]];
    }

    function CalcBMatrix(){
      return [[1/(R1*C1)], [0]];
    }

    function CalcUMatrix(t){
      return [[1]];
    }

    function CalcXDMatrix(){
      let AX = AMatrix.Multiply(XMatrix);
      let BU = BMatrix.Multiply(UMatrix);

      return AX.Add(BU);
    }

    function Step(){
      XDMatrix = CalcXDMatrix();
      console.log(XDMatrix);
      XMatrix = XMatrix.Add(XDMatrix);  // very simple integration, by adding dX/dt to X (assuming that base was 1[second])
      console.log((XMatrix));
    }

  </script>
</html>
